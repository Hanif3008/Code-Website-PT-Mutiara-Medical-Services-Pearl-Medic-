<div class="profile-company-section">
  <div class="profile-pic">
    <% if (perusahaan.photo_perusahaan && perusahaan.photo_perusahaan !== "") { %>
    <img src="/img/<%= perusahaan.photo_perusahaan %>" alt="profile" />
    <% } else { %>
    <img src="/img/company.jpg" alt="profile" />
    <% } %>
  </div>

  <form class="profile-wrapper" id="editProfileForm" method="post" action="/editprofile_client" enctype="multipart/form-data">
    <div class="profile-company-name">
      <h1>Edit Profil Akun</h1>
    </div>
    <div class="profil-akun-perusahaan" id="profil-akun-perusahaan">
      <div class="profil-akun-perusahaan-menu">
        <div class="profil-akun-perusahaan-option">
          <h3>Nama Perusahaan</h3>
          <div class="edit-profil">
            <i class="fa-solid fa-pen-to-square"></i>
            <input required type="text" name="nama_perusahaan" id="nama_perusahaan" value="<%= perusahaan.nama_perusahaan %>" placeholder="Masukan Nama Perusahaan . . ." />
          </div>
        </div>
        <div class="profil-akun-perusahaan-option">
          <h3>Bidang</h3>
          <div class="edit-profil">
            <i class="fa-solid fa-pen-to-square"></i>
            <input required type="text" name="bidang_perusahaan" id="bidang_perusahaan" value="<%= perusahaan.bidang_perusahaan %>" placeholder="Masukan Bidang Perusahaan . . ." />
          </div>
        </div>
        <div class="profil-akun-perusahaan-option">
          <h3>Email</h3>
          <div class="edit-profil">
            <i class="fa-solid fa-pen-to-square"></i>
            <input required type="email" name="email_perusahaan" id="email_perusahaan" value="<%= perusahaan.email_perusahaan %>" placeholder="ex = company@mail.com . . ." />
          </div>
        </div>
        <div class="profil-akun-perusahaan-option">
          <h3>Nomor Telepon</h3>
          <div class="edit-profil">
            <i class="fa-solid fa-pen-to-square"></i>
            <input required type="text" name="nomortelepon_perusahaan" id="nomortelepon_perusahaan" value="<%= perusahaan.nomortelepon_perusahaan %>" placeholder="Masukan Nomor Telepon Perusahaan . . ." />
          </div>
        </div>
        <div class="profil-akun-perusahaan-option">
          <h3>Ganti Foto</h3>
          <div class="edit-profil">
            <i class="fa-solid fa-pen-to-square"></i>
            <input type="file" name="photo" id="photo" class="input_img" />
            <% if (!perusahaan.photo_perusahaan) { %>
            <label for="photo" class="custom-file-upload">Pilih File</label>
            <% } %>
          </div>
          <img id="currentImage" src="/img/<%= perusahaan.photo_perusahaan %>" alt="Pratinjau Foto" />
        </div>
      </div>
      <div class="profil-akun-perusahaan-alamat">
        <h3>Alamat</h3>
        <input required type="text" name="alamat_perusahaan" id="alamat_perusahaan" value="<%= perusahaan.alamat_perusahaan %>" placeholder="Masukan Alamat Perusahaan . . ." />
      </div>
      <div class="validasi" id="validasi" style="display: none">
        <p id="validasi-message"></p>
      </div>
      <div class="profil-akun-perusahaan-button" id="button-edit">
        <div class="profil-akun-perusahaan-edit" id="konfirmasi">
          <button type="submit">
            Konfirmasi
            <i class="fa-solid fa-check"></i>
          </button>
        </div>
        <div class="profil-akun-perusahaan-logout" id="kembali">
          <a href="profile_client">
            Kembali
            <i class="fas fa-sign-out-alt"></i>
          </a>
        </div>
      </div>
    </div>
  </form>
</div>

<script>
  document.getElementById("photo").addEventListener("change", function (event) {
    var input = event.target;
    var img = document.getElementById("currentImage");
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function (e) {
        img.src = e.target.result;
      };
      reader.readAsDataURL(input.files[0]);
    } else {
      img.src = "/img/<%= perusahaan.photo_perusahaan %>";
    }
  });

  document.getElementById("editProfileForm").addEventListener("submit", function (e) {
    var valid = true;
    var message = "";

    var email = document.getElementById("email_perusahaan").value;
    var phone = document.getElementById("nomortelepon_perusahaan").value;

    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      valid = false;
      message = "Format email harap diperhatikan.";
    }

    if (!/^\d+$/.test(phone)) {
      valid = false;
      message = "Format nomor telepon harap diperhatikan.";
    }

    if (!valid) {
      e.preventDefault();
      var validasiDiv = document.getElementById("validasi");
      validasiDiv.style.display = "block";
      document.getElementById("validasi-message").textContent = message;
    }
  });
</script>

<style>
  #currentImage {
    margin-top: 15px;
    width: 100px;
    height: 100px;
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  }
  .validasi {
    padding: 20px;
    display: flex;
    text-align: center;
  }
  .validasi p {
    font-size: 12px;
    color: var(--red-color);
    border: 1px dashed var(--red-color);
    padding: 5px;
    width: 95%;
  }
  @media only screen and (max-width: 695px) {
    .validasi {
      padding: 15px;
      display: flex;
      text-align: center;
    }
    .validasi p {
      font-size: 10px;
      width: 95%;
    }
  }
  @media only screen and (max-width: 500px) {
    .validasi {
      padding: 15px;
      display: flex;
      text-align: center;
    }
    .validasi p {
      font-size: 8px;
      width: 90%;
    }
  }
</style>
