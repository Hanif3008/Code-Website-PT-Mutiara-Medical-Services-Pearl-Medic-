<div class="pelayanan_admin_section">
  <div class="pelayanan_dashboard_wrapper">
    <div class="PAdmin_left">
      <div class="Padmin_title">
        <h1>Edit <span>Profil Dokter</span></h1>
      </div>
      <div class="Padmin_pelayananmasuk">
        <div class="Padmin_pelayananmasuk_wrapper">
          <form action="/EditDetailDokter_admin/<%= DokterData.id_stafkesehatan %>" method="post" enctype="multipart/form-data" class="edit-profile-perusahaan" id="formEditDokter">
            <div class="Padmin_pelayananmasuk_pic">
              <img id="profilePic" src="/img/<%= DokterData.photo_stafkesehatan %>" alt="Company Pictures" />
              <span class="change-text">Ubah Gambar</span>
              <input type="file" name="photo_stafkesehatan" id="fileInput" accept="image/*" style="display: none" />
            </div>
            <div class="Padmin_pelayananmasuk_data">
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Nama Lengkap</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-user-nurse"></i>
                  <input type="text" name="namalengkap_stafkesehatan" id="namalengkap_stafkesehatan" value="<%= DokterData.namalengkap_stafkesehatan %>" placeholder="Masukan Nama Lengkap . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Username</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-user"></i>
                  <input type="text" name="username_stafkesehatan" id="username_stafkesehatan" value="<%= DokterData.username_stafkesehatan %>" placeholder="Masukan Username . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Password</h3>
                <p><i class="fa-solid fa-user-lock"></i><a href="/EditPassPDokter_admin/<%= DokterData.id_stafkesehatan %>">Ubah Password</a></p>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Spesialisasi</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-user-doctor"></i>
                  <input type="text" name="spesialisasi_stafkesehatan" id="spesialisasi_stafkesehatan" value="<%= DokterData.spesialisasi_stafkesehatan %>" placeholder="Masukan Spesialisasi Dokter . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Nomor Induk</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-user"></i>
                  <input type="text" name="noinduk_stafkesehatan" id="noinduk_stafkesehatan" value="<%= DokterData.noinduk_stafkesehatan %>" placeholder="Masukan Username . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Email</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-envelope"></i>
                  <input type="email" name="email_stafkesehatan" id="email_stafkesehatan" value="<%= DokterData.email_stafkesehatan %>" placeholder="Masukan Email Perusahaan . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Nomor Telepon</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-square-phone"></i>
                  <input type="text" name="nomortelepon_stafkesehatan" id="nomortelepon_stafkesehatan" value="<%= DokterData.nomortelepon_stafkesehatan %>" placeholder="Masukan Nomor Telepon . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Status</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <select name="status" id="status">
                    <option value="0" disabled selected>-- Pilih Status Akun --</option>
                    <option value="1" <%= DokterData.status === 1 ? 'selected' : '' %>>Bertugas</option>
                    <option value="0" <%= DokterData.status === 0 ? 'selected' : '' %>>Tidak Bertugas</option>
                  </select>
                </div>
              </div>
            </div>
            <br>
            <br>
            <br>
            <input type="hidden" name="existing_photo_doctor" id="existing_photo_doctor" value="<%= DokterData.photo_stafkesehatan %>">
            <div class="edit-all-button">
              <div class="edit-menu-button">
                <button type="submit">Edit Profil</button>
              </div>
              <div class="back-menu-button">
                <a href="/LDokter_admin">Kembali</a>
              </div>
            </div>
             <div class="validasi" id="validasi">
              <p id="validasi_text">Pastikan data yang anda masukkan benar dan valid</p>
            </div>
          </form>
        </div>
      </div>
      <div class="Padmin_notifikasi_obatvaksin_responsive" id="none">
        <div class="Padmin_notifikasi_obatvaksin">
          <div class="Padmin_notifikasi_title">
            <h2>Stok<span>Obat</span></h2>
          </div>
          <div class="Padmin_stok_obatvaksin">
            <a href="/StokObat_admin">Lihat Stok Obat</a>
          </div>
        </div>
        <div class="Padmin_notifikasi_obatvaksin">
          <div class="Padmin_notifikasi_title">
            <h2>Stok<span>Vaksin</span></h2>
          </div>
          <div class="Padmin_stok_obatvaksin">
            <a href="/StokVaksin_admin">Lihat Stok Vaksin</a>
          </div>
        </div>
      </div>
    </div>
    <div class="PAdmin_right">
      <div class="Padmin_notifikasi_wrapper">
          <div class="Padmin_notifikasi_obatvaksin">
            <div class="Padmin_notifikasi_title">
              <h2>Stok<span>Obat</span></h2>
            </div>
            <div class="Padmin_stok_obatvaksin">
              <a href="/StokObat_admin">Lihat Stok Obat</a>
            </div>
          </div>
          <div class="Padmin_notifikasi_obatvaksin">
            <div class="Padmin_notifikasi_title">
              <h2>Stok<span>Vaksin</span></h2>
            </div>
            <div class="Padmin_stok_obatvaksin">
              <a href="/StokVaksin_admin">Lihat Stok Vaksin</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  document.querySelector(".Padmin_pelayananmasuk_pic").addEventListener("click", function () {
    document.getElementById("fileInput").click();
  });

  document.getElementById("fileInput").addEventListener("change", function (event) {
    const reader = new FileReader();
    reader.onload = function () {
      document.getElementById("profilePic").src = reader.result;
    };
    reader.readAsDataURL(event.target.files[0]);
  });
</script>

<style>
    .validasi {
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    margin-top: 10px;
    border: 1px dashed var(--red-color);
    padding: 5px;
    text-align: center;
  }
  .validasi p {
    color: var(--red-color);
    font-size: 12px;
    text-align: center;
  }
</style>


<script>
  document.getElementById('formEditDokter').addEventListener('submit', function(event) {
    event.preventDefault();
    const namaLengkap = document.getElementById('namalengkap_stafkesehatan').value.trim();
    const username = document.getElementById('username_stafkesehatan').value.trim();
    const spesialisasi = document.getElementById('spesialisasi_stafkesehatan').value.trim();
    const noInduk = document.getElementById('noinduk_stafkesehatan').value.trim();
    const email = document.getElementById('email_stafkesehatan').value.trim();
    const nomorTelepon = document.getElementById('nomortelepon_stafkesehatan').value.trim();
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    const nomorPattern = /^\d+$/;
    const usernamePattern = /^[a-zA-Z0-9]+$/;

    let valid = true;
    let errorMessage = '';

    // nama lenkap wajib diisi
    if (!namaLengkap) {
      valid = false;
      errorMessage += 'Nama lengkap wajib diisi.<br>';
    }
    // username wajib diisi dan hanya mengandung huruf dan angka lebih dari 8 karakter
    if (!username || username.length < 8 || !usernamePattern.test(username)) {
      valid = false;
      errorMessage += 'Username harus diisi dan hanya mengandung huruf dan angka lebih dari 8 karakter.<br>';
    }
    if (!spesialisasi) {
      valid = false;
      errorMessage += 'Spesialisasi harus diisi.<br>';
    }
    if (!nomorPattern.test(noInduk)) {
      valid = false;
      errorMessage += 'Nomor induk harus diisi dan hanya mengandung angka.<br>';
    }
    if (!emailPattern.test(email)) {
      valid = false;
      errorMessage += 'Email harus diisi dengan format yang benar.<br>';
    }
    if (!nomorPattern.test(nomorTelepon) || nomorTelepon.length < 10 || nomorTelepon.length > 13) {
      valid = false;
      errorMessage += 'Nomor telepon harus diisi dengan format yang benar.<br>';
    }

    const validasi = document.getElementById('validasi');
    const validasiText = document.getElementById('validasi_text');

    if (valid) {
      validasi.style.display = 'none';
      this.submit();
    } else {
      validasiText.innerHTML = errorMessage;
      validasi.style.display = 'flex';
    }
  });
</script>