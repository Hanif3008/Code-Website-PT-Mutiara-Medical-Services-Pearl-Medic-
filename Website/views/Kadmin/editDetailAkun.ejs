<div class="pelayanan_admin_section">
  <div class="pelayanan_dashboard_wrapper">
    <div class="PAdmin_left">
      <div class="Padmin_title">
        <h1>Edit <span>Profil Perusahaan</span></h1>
      </div>
      <div class="Padmin_pelayananmasuk">
        <div class="Padmin_pelayananmasuk_wrapper">
          <form id="editProfileForm" class="edit-profile-perusahaan" method="POST" action="/updateDetailAkun/<%= akunStafAdmin.id_stafadmin %>" enctype="multipart/form-data">
            <div class="Padmin_pelayananmasuk_pic">
              <img id="profilePic" src="/img/<%= akunStafAdmin.photo_stafadmin %>" alt="Company Pictures" />
              <span class="change-text">Ubah Gambar</span>
              <input type="file" name="photo_kstafadmin" id="fileInput" accept="image/*" style="display: none" />
            </div>
            <div class="Padmin_pelayananmasuk_data">
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Nama Lengkap</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-building"></i>
                  <input type="text" name="nama_lengkap" id="nama_lengkap" value="<%= akunStafAdmin.namalengkap_stafadmin %>" placeholder="Masukan Nama Lengkap . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Username</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-school-circle-check"></i>
                  <input type="text" name="username" id="username" value="<%= akunStafAdmin.username_stafadmin %>" placeholder="Masukan Username  . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Email</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-envelope"></i>
                  <input type="email" name="email" id="email" value="<%= akunStafAdmin.email_stafadmin %>" placeholder="Masukan Email  . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Nomor Telepon</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-square-phone"></i>
                  <input type="text" name="nomor_telepon" id="nomor_telepon" value="<%= akunStafAdmin.nomortelepon_stafadmin %>" placeholder="Masukan Nomor Telepon . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Nomor Induk</h3>
                <div class="Padmin_pelayananmasuk_datamenu_input">
                  <i class="fa-solid fa-school-circle-check"></i>
                  <input type="text" name="no_induk" id="no_induk" value="<%= akunStafAdmin.noinduk_stafadmin %>" placeholder="Masukan Nomor Induk . . ." />
                </div>
              </div>
              <div class="Padmin_pelayananmasuk_datamenu">
                <h3>Status Akun</h3>
                <select name="status" id="status">
                  <option value="1" <%= akunStafAdmin.status_stafadmin === 1 ? 'selected' : '' %>>Aktif</option>
                  <option value="0" <%= akunStafAdmin.status_stafadmin === 0 ? 'selected' : '' %>>Tidak Aktif</option>
                </select>
              </div>
              <style>
                .Padmin_pelayananmasuk_datamenu select {
                  width: 100px;
                  padding: 5px;
                  border-radius: 5px;
                  border: none;
                  outline: none;
                  background-color: var(--cream-color);
                  color: var(--secondary-color);
                  cursor: pointer;
                }
              </style>
            </div>
            <br />
            <br />
            <br />
            <input type="hidden" name="existing_photo_stafadmin" value="<%= akunStafAdmin.photo_stafadmin %>" />
            <div class="edit-all-button">
              <div class="edit-menu-button">
                <button type="submit">Konfirmasi</button>
              </div>
              <div class="back-menu-button">
                <a href="/index_Kadmin">Kembali</a>
              </div>
            </div>
            <div class="validasi" id="validasi">
              <p id="validasi_text">Pastikan data yang anda masukkan benar dan valid</p>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div class="PAdmin_right"></div>
  </div>
</div>
<script>
  document.querySelector(".Padmin_pelayananmasuk_pic").addEventListener("click", function () {
    document.getElementById("fileInput").click();
  });

  document.getElementById("fileInput").addEventListener("change", function (event) {
    const reader = new FileReader();
    reader.onload = function () {
      document.getElementById("profilePic").src = reader.result;
    };
    reader.readAsDataURL(event.target.files[0]);
  });

  document.getElementById("editProfileForm").addEventListener("submit", function (event) {
    const namaLengkap = document.getElementById("nama_lengkap").value;
    const username = document.getElementById("username").value;
    const email = document.getElementById("email").value;
    const nomorTelepon = document.getElementById("nomor_telepon").value;
    const validasiDiv = document.getElementById("validasi");

    let valid = true;
    let validasiText = "Pastikan data yang anda masukkan benar dan valid";

    if (!/^[a-zA-Z\s]+$/.test(namaLengkap)) {
      valid = false;
      validasiText = "Nama lengkap hanya boleh berisi huruf";
    } else if (!/^(?=.*[a-zA-Z])(?=.*\d)[a-zA-Z\d]+$/.test(username)) {
      valid = false;
      validasiText = "Username harus berisi kombinasi huruf dan angka";
    } else if (!/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(email)) {
      valid = false;
      validasiText = "Email tidak sesuai format";
    } else if (!/^\d+$/.test(nomorTelepon)) {
      valid = false;
      validasiText = "Nomor telepon hanya boleh berisi angka";
    }

    if (!valid) {
      event.preventDefault();
      validasiDiv.style.display = "flex";
      document.getElementById("validasi_text").innerText = validasiText;
    } else {
      validasiDiv.style.display = "none";
    }
  });
</script>
<style>
  .validasi {
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    margin-top: 10px;
    border: 1px dashed var(--red-color);
    padding: 5px;
    text-align: center;
  }
  .validasi p {
    color: var(--red-color);
    font-size: 12px;
    text-align: center;
  }
</style>
