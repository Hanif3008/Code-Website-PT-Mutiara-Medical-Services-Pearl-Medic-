<div class="pelayanan_admin_section">
  <div class="pelayanan_dashboard_wrapper">
    <div class="PAdmin_left">
      <div class="Padmin_title">
        <h1>Tambah Rekam Medis<span> Pesanan <%= results.nomorpesanan %></span></h1>
      </div>
      <div class="Padmin_pelayananmasuk">
        <form class="Padmin_formulir_rekammedis" id="rekamMedisFormV" action="/Tambah_DataRekamMedis_vaksinasi_dokter" method="POST">
          <div class="Padmin_formulir_datadiri">
            <div class="Padmin_formulir_title">
              <h3>Data Pribadi Pasien</h3>
            </div>
            <div class="Padmin_formulir_input">
              <div class="Padmin_formulir_input_option">
                <label for="nama_lengkap">Nama Lengkap</label>
                <input type="text" id="nama_lengkap" name="nama_lengkap" placeholder="Masukan Nama Lengkap . . ." required />
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="nik">Nomor Identitas (NIK)</label>
                <input type="text" id="nomor_identitas" name="nomor_identitas" placeholder="Masukan Nomor Identitas (NIK/KTP) . . ." required />
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="tanggal_lahir">Tanggal Lahir</label>
                <input type="date" id="tanggal_lahir" name="tanggal_lahir" required />
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="jenis_kelamin">Jenis Kelamin</label>
                <select name="jenis_kelamin" id="jenis_kelamin" required>
                  <option value="Laki-laki">Laki-laki</option>
                  <option value="Perempuan">Perempuan</option>
                </select>
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="nomor_telepon">Nomor Telepon</label>
                <input type="text" id="nomor_telepon" name="nomor_telepon" placeholder="Masukan Nomor Telepon . . ." required />
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Masukan Email . . ." required />
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="alamat">Alamat</label>
                <textarea id="alamat" name="alamat" cols="30" rows="4" placeholder="Masukan Alamat . . ." required></textarea>
              </div>
            </div>
          </div>
          <div class="Padmin_formulir_datadiri" id="Padmin_formulir_datadiri">
            <div class="Padmin_formulir_title">
              <h3>Informasi Vaksinasi</h3>
            </div>
            <div class="Padmin_formulir_input">
              <div class="Padmin_formulir_input_option">
                <label for="jenis_vaksin">Jenis Vaksin</label>
                <h4>: Sinovac</h4>
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="tanggal_vaksin">Tanggal Vaksinasi</label>
                <h4>: 21/08/24</h4>
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="lokasi_vaksin">Lokasi Vaksinasi</label>
                <h4>: RSUD Dr. Soetomo</h4>
              </div>
            </div>
          </div>
          <div class="Padmin_formulir_datadiri">
            <div class="Padmin_formulir_title">
              <h3>Hasil Kondisi Setelah Menerima Vaksin</h3>
            </div>
            <div class="Padmin_formulir_input">
              <div class="Padmin_formulir_input_option">
                <label for="reaksi_pasien">Reaksi Setelah Vaksinasi</label>
                <select name="reaksi_pasien" id="reaksi_pasien" required>
                  <option value="0" disabled selected>-- Pilih Reaksi --</option>
                  <option value="Tidak ada reaksi">Tidak ada reaksi</option>
                  <option value="Demam">Demam</option>
                  <option value="Nyeri di tempat suntikan">Nyeri di tempat suntikan</option>
                  <option value="Lelah">Lelah</option>
                  <option value="Alergi ringan">Alergi ringan</option>
                </select>
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="deskripsi_kondisi">Deskripsi Kondisi Setelah Vaksinasi</label>
                <textarea id="deskripsi_kondisi" name="deskripsi_kondisi" cols="30" rows="4" placeholder="Masukan Deskripsi Kondisi Setelah Vaksinasi . . ." required></textarea>
              </div>
              <div class="Padmin_formulir_input_option">
                <label for="perawatan_lanjutan">Perawatan Lanjutan</label>
                <textarea id="perawatan_lanjutan" name="perawatan_lanjutan" cols="30" rows="4" placeholder="Tulis Tidak Ada Jika Tak Ada Perawatan Lanjutan. . ." required></textarea>
              </div>
            </div>
          </div>
          <input type="hidden" name="jenis_vaksin" id="jenis_vaksin" value="<%= results.nama_vaksin %>" />
          <input type="hidden" name="tanggal_vaksinasi" id="tanggal_vaksinasi" value="<%= results.tanggalpelayanan_vaksin%>" />
          <input type="hidden" name="lokasi_vaksinasi" id="lokasi_vaksinasi" value="<%= results.lokasipelayanan_vaksin %>" />
          <input type="hidden" name="nomorpesanan" id="nomorpesanan" value="<%= results.nomorpesanan %>" />
          <input type="hidden" name="id_vaksinasi" id="id_vaksinasi" value="<%= results.id %>" />
          <div class="confirm-button">
            <button type="submit" class="btn btn-primary">Tambah Data</button>
            <!-- <a href="/DataRekamMedis_vaksinasi_dokter">Batalkan</a> -->
          </div>
          <span id="errorPesan" style="color: red; font-size: 12px; display: none"></span>
        </form>
      </div>
    </div>
  </div>
</div>

<style>
  .pelayanan_dashboard_wrapper {
    display: grid;
    grid-template-columns: 1fr;
  }
  .Padmin_pelayananmasuk {
    padding: 10px;
    padding-right: 20px;
    padding-left: 0px;
  }
  #errorPesan {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    width: 100%;
    border: 1px dotted red;
    padding: 10px;
  }
</style>

<script>
  const form = document.getElementById("rekamMedisFormV");
  const namaInput = document.getElementById("nama_lengkap");
  const nomorIdentitasInput = document.getElementById("nomor_identitas");
  const tanggalLahirInput = document.getElementById("tanggal_lahir");
  const jenisKelaminInput = document.getElementById("jenis_kelamin");
  const nomorTeleponInput = document.getElementById("nomor_telepon");
  const emailInput = document.getElementById("email");
  const alamatInput = document.getElementById("alamat");
  const reaksiPasienInput = document.getElementById("reaksi_pasien");
  const deskripsiKondisiInput = document.getElementById("deskripsi_kondisi");
  const perawatanLanjutanInput = document.getElementById("perawatan_lanjutan");
  const errorPesan = document.getElementById("errorPesan");
  form.addEventListener("submit", function (e) {
    let isValid = true;
    let messages = [];

    // Validasi Nama Lengkap
    const nama = namaInput.value.trim();
    if (!/^[a-zA-Z\s]+$/.test(nama)) {
      messages.push("Nama Lengkap hanya boleh berisi huruf.");
      isValid = false;
    } else if (nama.length <= 8) {
      messages.push("Nama harus lebih dari 8 karakter.");
      isValid = false;
    }

    // Validasi Nomor Identitas
    const nik = nomorIdentitasInput.value.trim();
    if (!/^\d{16}$/.test(nik)) {
      messages.push("Nomor Identitas harus terdiri dari 16 digit angka.");
      isValid = false;
    }

    // Validasi Tanggal Lahir
    const tanggalLahir = tanggalLahirInput.value.trim();
    if (!tanggalLahir) {
      messages.push("Tanggal Lahir wajib diisi.");
      isValid = false;
    } else {
      const today = new Date();
      const birthDate = new Date(tanggalLahir);
      const age = today.getFullYear() - birthDate.getFullYear();
      const monthDifference = today.getMonth() - birthDate.getMonth();
      const dayDifference = today.getDate() - birthDate.getDate();
      if (age < 14 || (age === 14 && monthDifference < 0) || (age === 14 && monthDifference === 0 && dayDifference < 0)) {
        messages.push("Usia harus lebih dari 14 tahun.");
        isValid = false;
      }
    }

    // Validasi Jenis Kelamin
    if (!jenisKelaminInput.value) {
      messages.push("Jenis Kelamin wajib dipilih.");
      isValid = false;
    }

    // Validasi Nomor Telepon
    const nomorTelepon = nomorTeleponInput.value.trim();
    if (!/^(\+62|0)[8][1-9][0-9]{6,9}$/.test(nomorTelepon)) {
      messages.push("Nomor Telepon tidak valid sesuai format.");
      isValid = false;
    }

    // Validasi Email
    const email = emailInput.value.trim();
    if (!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(email)) {
      messages.push("Isi format email dengan benar.");
      isValid = false;
    }

    // Validasi Alamat
    const alamat = alamatInput.value.trim();
    if (!alamat) {
      messages.push("Alamat wajib diisi.");
      isValid = false;
    }

    // Validasi Reaksi Pasien
    if (!reaksiPasienInput.value) {
      messages.push("Reaksi Pasien wajib dipilih.");
      isValid = false;
    }

    // Validasi Deskripsi Kondisi
    const deskripsiKondisi = deskripsiKondisiInput.value.trim();
    if (!deskripsiKondisi) {
      messages.push("Deskripsi Kondisi wajib diisi.");
      isValid = false;
    }

    if (!isValid) {
      e.preventDefault();
      errorPesan.innerHTML = messages.map((msg) => `<li>${msg}</li>`).join("");
      errorPesan.style.display = "block";
    } else {
      errorPesan.style.display = "none"; // Sembunyikan pesan jika tidak ada error
    }
  });
</script>
